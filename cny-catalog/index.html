<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 ä¸™åˆé©¬å¹´ - çƒŸèŠ±å…¨ç³»åˆ—ç›®å½•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #b91c1c; 
            background-image: radial-gradient(circle at 2px 2px, rgba(255,255,255,0.05) 1px, transparent 0);
            background-size: 40px 40px;
        }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .animate-slide-up { animation: slideUp 0.3s ease-out; }
        
        .product-card:active { transform: scale(0.98); }
        .category-btn.active { 
            background-color: #facc15; 
            color: #b91c1c;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="text-white pb-24">

    <!-- é¡¶éƒ¨ä»£ç†ä¿¡æ¯æ  -->
    <div id="agent-banner" class="bg-yellow-500 text-red-900 text-center py-1 text-[10px] font-black uppercase tracking-widest">
        æ­£åœ¨ä¸ºæ‚¨è¿æ¥ä¸“å±é¡¾é—®: <span id="display-agent-name">å®˜æ–¹å®¢æœ</span>
    </div>

    <!-- å¯¼èˆªæ  -->
    <nav class="sticky top-0 z-50 bg-red-800/95 backdrop-blur-md border-b border-yellow-500/30 px-4 py-3 flex justify-between items-center shadow-xl">
        <div class="flex flex-col">
            <span class="font-black text-lg text-yellow-400 leading-none">2026 ä¸™åˆé©¬å¹´</span>
            <span class="text-[9px] text-yellow-200/70 mt-1 uppercase tracking-tighter">Fireworks Catalogue</span>
        </div>
        <button onclick="toggleCart()" class="relative p-2 bg-yellow-500 text-red-900 rounded-full shadow-lg">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
            <span id="cart-count" class="absolute -top-1 -right-1 bg-white text-red-600 text-[10px] font-black px-1.5 py-0.5 rounded-full border border-red-600">0</span>
        </button>
    </nav>

    <!-- å¤´éƒ¨å…¬å‘Š -->
    <header class="py-8 px-4 text-center">
        <h1 class="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-b from-yellow-100 to-yellow-500 mb-1">
            æ–°æ˜¥çƒŸç«å¤§å…¨
        </h1>
        <p class="text-yellow-100/60 text-xs italic">å…¨ç³»åˆ—çˆ†æ¬¾ Â· ç°è´§ä¾›åº” Â· ä¸¥é€‰å“è´¨</p>
    </header>

    <!-- åˆ†ç±»ç­›é€‰å™¨ -->
    <div class="sticky top-[60px] z-40 bg-red-900/80 backdrop-blur-sm py-3 mb-4">
        <div class="flex gap-2 overflow-x-auto px-4 hide-scrollbar" id="category-list">
            <button onclick="filterProducts('all')" class="category-btn active whitespace-nowrap px-4 py-1.5 rounded-full text-xs font-black border border-yellow-500/30 transition-all">å…¨éƒ¨</button>
            <button onclick="filterProducts('æ‰‹æŒç³»åˆ—')" class="category-btn whitespace-nowrap px-4 py-1.5 rounded-full text-xs font-black border border-yellow-500/30 transition-all">ğŸª„ æ‰‹æŒç³»åˆ—</button>
            <button onclick="filterProducts('èŠ±ç­’/ç©å…·')" class="category-btn whitespace-nowrap px-4 py-1.5 rounded-full text-xs font-black border border-yellow-500/30 transition-all">ğŸ¤¡ è¶£å‘³ç©å…·</button>
            <button onclick="filterProducts('é­ç‚®ç³»åˆ—')" class="category-btn whitespace-nowrap px-4 py-1.5 rounded-full text-xs font-black border border-yellow-500/30 transition-all">ğŸ§¨ ä¼ ç»Ÿé­ç‚®</button>
            <button onclick="filterProducts('å‘å•ç³»åˆ—')" class="category-btn whitespace-nowrap px-4 py-1.5 rounded-full text-xs font-black border border-yellow-500/30 transition-all">âœ¨ å‘å•ç³»åˆ—</button>
            <button onclick="filterProducts('åç /ç«ç®­')" class="category-btn whitespace-nowrap px-4 py-1.5 rounded-full text-xs font-black border border-yellow-500/30 transition-all">ğŸš€ åç ç«ç®­</button>
            <button onclick="filterProducts('ç›†èŠ±ç»„åˆ')" class="category-btn whitespace-nowrap px-4 py-1.5 rounded-full text-xs font-black border border-yellow-500/30 transition-all">ğŸ† ç›†èŠ±/å¤§ç»„åˆ</button>
        </div>
    </div>

    <!-- äº§å“ç½‘æ ¼ -->
    <main class="container mx-auto px-3 pb-12">
        <div id="product-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 md:gap-6">
            <!-- æ¸²æŸ“å†…å®¹ -->
        </div>
    </main>

    <!-- å›¾ç‰‡/è§†é¢‘å¼¹çª— -->
    <div id="image-lightbox" class="fixed inset-0 z-[100] bg-black/95 hidden items-center justify-center p-4" onclick="closeLightbox()">
        <img id="lightbox-img" src="" class="max-w-full max-h-[85vh] rounded-lg shadow-2xl">
    </div>

    <div id="video-lightbox" class="fixed inset-0 z-[100] bg-black/95 hidden items-center justify-center p-4" onclick="closeVideo()">
        <div class="relative w-full max-w-2xl aspect-video bg-black rounded-2xl overflow-hidden shadow-2xl" onclick="event.stopPropagation()">
            <video id="product-video" controls playsinline class="w-full h-full"></video>
            <button class="absolute top-3 right-3 bg-black/50 text-white w-8 h-8 rounded-full text-xl" onclick="closeVideo()">&times;</button>
        </div>
    </div>

    <!-- è´­ç‰©è½¦æŠ½å±‰ -->
    <div id="cart-modal" class="fixed inset-0 z-[60] bg-black/80 hidden items-end justify-center">
        <div class="bg-white text-gray-800 w-full max-w-lg rounded-t-3xl overflow-hidden shadow-2xl animate-slide-up">
            <div class="bg-red-700 p-5 text-white flex justify-between items-center">
                <div>
                    <h2 class="text-lg font-black italic">æˆ‘çš„ä¸‹å•æ¸…å•</h2>
                    <p class="text-[10px] text-yellow-300 italic">ä¸“å±é¡¾é—®: <span id="cart-agent-name">å®˜æ–¹</span></p>
                </div>
                <div class="flex items-center gap-4">
                    <button onclick="clearCart()" class="text-white/60 hover:text-white text-[10px] font-bold border border-white/20 px-2 py-1 rounded">æ¸…ç©ºæ¸…å•</button>
                    <button onclick="toggleCart()" class="text-white/60 hover:text-white text-3xl">&times;</button>
                </div>
            </div>
            <div id="cart-items" class="max-h-[50vh] overflow-y-auto p-5 space-y-4"></div>
            <div class="p-5 border-t border-gray-100 bg-gray-50">
                <div class="flex justify-between items-center mb-5 px-1">
                    <span class="text-gray-400 font-bold">é¢„è®¡æ€»é¢:</span>
                    <span id="cart-total-price" class="text-2xl font-black text-red-600 tracking-tighter">RM 0.00</span>
                </div>
                <button onclick="checkout()" class="w-full bg-[#25D366] text-white py-4 rounded-xl font-black text-lg shadow-lg flex items-center justify-center gap-2 active:scale-95 transition-transform">
                    ç¡®è®¤å¹¶å‘é€ WhatsApp è®¢å•
                </button>
            </div>
        </div>
    </div>

    <script>
        const agents = {
            'ag1': { name: 'ä»£ç† A (é›ªéš†)', phone: '60129540804' },
            'ag2': { name: 'ä»£ç† B (åŒ—é©¬)', phone: '60129283393' },
            'hq': { name: 'å®˜æ–¹å®¢æœ', phone: '60105330000' }
        };

        const urlParams = new URLSearchParams(window.location.search);
        const agentId = urlParams.get('id') || 'hq';
        const currentAgent = agents[agentId] || agents['hq'];
        document.getElementById('display-agent-name').innerText = currentAgent.name;
        document.getElementById('cart-agent-name').innerText = currentAgent.name;

        // äº§å“æ•°æ®åº“ (å·²ä¿®å¤åç§°å¼•å·å¯¼è‡´çš„ç‚¹å‡»å¤±æ•ˆ)
        const products = [
            // æ‰‹æŒç³»åˆ—
            { id: 'PM11N', name: 'å°éœå…‰', price: 10, category: 'æ‰‹æŒç³»åˆ—', isHot: true },
            { id: '11', name: 'å››è‰²èŠ±', price: 12, category: 'æ‰‹æŒç³»åˆ—', isHot: false },
            { id: 'PM22N', name: '7" ç”µå…‰èŠ±', price: 8, category: 'æ‰‹æŒç³»åˆ—', isHot: false },
            { id: 'PM33N', name: 'å°å®‰å…¨', price: 15, category: 'æ‰‹æŒç³»åˆ—', isHot: false },
            { id: '33', name: 'å¤œç©ºä¹‹æ˜Ÿ', price: 20, category: 'æ‰‹æŒç³»åˆ—', isHot: false },
            { id: '33N', name: 'å½©è‰²æ£’', price: 5, category: 'æ‰‹æŒç³»åˆ—', isHot: false },
            { id: 'PM2525N', name: '18å¯¸é‡‘è‰²ç”µå…‰èŠ±', price: 15, category: 'æ‰‹æŒç³»åˆ—', isHot: false },
            { id: '2525', name: '18å¯¸å¿«ä¹å°ç¥é­', price: 15, category: 'æ‰‹æŒç³»åˆ—', isHot: false },
            { id: 'PM3636N', name: '14å¯¸ç”µå…‰èŠ±', price: 10, category: 'æ‰‹æŒç³»åˆ—', isHot: false },
            { id: 'PM3939N', name: 'å¤§å·éœå…‰', price: 18, category: 'æ‰‹æŒç³»åˆ—', isHot: false },

            // èŠ±ç­’ç³»åˆ— / çƒŸèŠ±ç©å…·ç³»åˆ—
            { id: 'PM44N', name: '7" é›ªç³•', price: 18, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: 'PM4545N', name: '10å¯¸é›ªç³•', price: 22, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: 'PM4848N', name: '15å¯¸é›ªç³•', price: 28, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: 'PM66N', name: 'æ˜¥å¤©èŠ­è•¾', price: 25, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: 'PM77N', name: 'ç‚¸ç å¤§åœ°å¼€èŠ±', price: 30, category: 'èŠ±ç­’/ç©å…·', isHot: true },
            { id: 'PM88N', name: 'å‘è´¢æ ‘', price: 35, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: '88', name: 'æ¬¢ä¹èŠ±ä»™', price: 22, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: 'PM99N', name: 'è²èŠ±å¼€', price: 28, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: 'PM1010N', name: 'èŒ¶èŠ±é¦™', price: 16, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: 'PM1212N', name: 'é¾™è›‹', price: 12, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: 'PM2727N', name: '50å‘é£å¤©é¼ ', price: 35, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: 'PM2828N', name: 'å°é»„èœ‚', price: 10, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: 'PM3030N', name: 'å¤ªç©ºé£ç¢Ÿ', price: 20, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: '3030N', name: 'åŒå½©è¿ç¯èœ‚', price: 18, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: '3030', name: 'æ°´æ¯å¥‡ç¼˜', price: 22, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: 'PM3232N', name: 'é‡‘ç‰æ»¡å ‚', price: 30, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: 'PM5050N', name: 'å½©è‰²å°é‡‘é±¼ (POP POP)', price: 5, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: 'PM5050N_B', name: 'å½©è‰²å¤§é²¨é±¼ (POP POP B)', price: 8, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: 'PM5656N', name: 'æ¬¢ä¹æ´¾å¯¹', price: 12, category: 'èŠ±ç­’/ç©å…·', isHot: false },
            { id: '5757', name: 'é“¶èŠ±æŠ¥å–œ', price: 35, category: 'èŠ±ç­’/ç©å…·', isHot: false },

            // é­ç‚®ç³»åˆ—
            { id: 'PM1313N', name: '8å°ºçº¢ç‚®', price: 40, category: 'é­ç‚®ç³»åˆ—', isHot: false },
            { id: '1313', name: '8å°ºç«ç‘°çº¢ç‚®', price: 45, category: 'é­ç‚®ç³»åˆ—', isHot: true },
            { id: 'PM1414N', name: 'èˆè‰²è¿å–œ', price: 50, category: 'é­ç‚®ç³»åˆ—', isHot: false },
            { id: '50K', name: '50000çº¢ç‚®', price: 150, category: 'é­ç‚®ç³»åˆ—', isHot: false },
            { id: '1414', name: '88å°ºç‰¹çº¢ç‚®', price: 200, category: 'é­ç‚®ç³»åˆ—', isHot: false },
            { id: '1414N', name: '88å°ºé»„é‡‘æ»¡åœ°', price: 220, category: 'é­ç‚®ç³»åˆ—', isHot: false },
            { id: 'PM1515N', name: '38å°ºå½©å…‰ç‰¹çº¢', price: 130, category: 'é­ç‚®ç³»åˆ—', isHot: false },
            { id: '1515N', name: '38å°ºé»„é‡‘æ»¡åœ°', price: 120, category: 'é­ç‚®ç³»åˆ—', isHot: false },
            { id: '1515', name: '38å°ºé¾™å‡¤åŒé£', price: 140, category: 'é­ç‚®ç³»åˆ—', isHot: false },
            { id: '1515VIP', name: '108å°ºç«ç‘°çº¢', price: 300, category: 'é­ç‚®ç³»åˆ—', isHot: true },
            { id: 'PM3434N', name: 'ç«æŸ´ç‚®', price: 5, category: 'é­ç‚®ç³»åˆ—', isHot: false },
            { id: 'PM3838N', name: 'é¡ºåˆ©çº¢', price: 15, category: 'é­ç‚®ç³»åˆ—', isHot: false },

            // å‘å•ç³»åˆ—
            { id: 'PM4040N', name: 'æ··åˆé›¨æ‰“èŠ­è•‰', price: 30, category: 'å‘å•ç³»åˆ—', isHot: false },
            { id: '4040', name: '3å‘é›¨æ‰“èŠ­è•‰', price: 15, category: 'å‘å•ç³»åˆ—', isHot: false },
            { id: 'PM4242N', name: 'å°é›¨æ‰“èŠ­è•‰', price: 10, category: 'å‘å•ç³»åˆ—', isHot: false },

            // åç ç³»åˆ— / ç«ç®­ç³»åˆ—
            { id: 'PM1111N', name: '20å‘é­”æœ¯è›‹', price: 45, category: 'åç /ç«ç®­', isHot: false },
            { id: 'PM2626N', name: '30å‘é­”æœ¯è›‹', price: 40, category: 'åç /ç«ç®­', isHot: false },
            { id: 'PM4444N', name: '10æ³¢éœ¹é›³é›¨', price: 28, category: 'åç /ç«ç®­', isHot: false },
            { id: 'PM4747N', name: '8æ³¢ç½—é©¬çƒ›å…‰', price: 18, category: 'åç /ç«ç®­', isHot: false },
            { id: 'PM3737N', name: 'ç‚¸ç å“å¤©é›·', price: 20, category: 'åç /ç«ç®­', isHot: false },
            { id: '3737', name: 'ç‹¼åšç«ç®­', price: 25, category: 'åç /ç«ç®­', isHot: false },
            { id: 'PM4141N', name: 'å•¸å£°æœˆæ—…è¡Œ', price: 20, category: 'åç /ç«ç®­', isHot: false },

            // ç›†èŠ±ç»„åˆç³»åˆ—
            { id: 'PM1616N', name: '9å¯¸138å‘ç›†èŠ±', price: 450, category: 'ç›†èŠ±ç»„åˆ', isHot: false },
            { id: '1616', name: 'äº¿ä¸‡å¯Œç¿ç»„åˆ', price: 480, category: 'ç›†èŠ±ç»„åˆ', isHot: true },
            { id: 'PM1717N', name: '4" å‘ç›†èŠ±', price: 120, category: 'ç›†èŠ±ç»„åˆ', isHot: false },
            { id: 'PM2323N', name: '4å¯¸16å‘ç›†èŠ±', price: 150, category: 'ç›†èŠ±ç»„åˆ', isHot: false },
            { id: 'PM2424N', name: '4" 36å‘ç›†èŠ±', price: 180, category: 'ç›†èŠ±ç»„åˆ', isHot: false },
            { id: '2424N', name: 'é—ªäº®ç¾äºº100å‘', price: 380, category: 'ç›†èŠ±ç»„åˆ', isHot: true },
            { id: 'PM4646N', name: '4å¯¸25å‘ç›†èŠ±', price: 160, category: 'ç›†èŠ±ç»„åˆ', isHot: false },
            { id: '4168*', name: '4å¯¸168å‘ç»„åˆçƒŸèŠ±', price: 280, category: 'ç›†èŠ±ç»„åˆ', isHot: false },
            { id: 'V4168*', name: 'VIP 4å¯¸168å‘ç»„åˆçƒŸèŠ±', price: 350, category: 'ç›†èŠ±ç»„åˆ', isHot: true },
            { id: 'JT0580', name: '9å¯¸80å‘ä¸ƒå½©ç¥¥äº‘', price: 400, category: 'ç›†èŠ±ç»„åˆ', isHot: false },
            { id: 'JT1138', name: '12å¯¸138å‘å¸•æ‹‰æ¢…æ‹‰', price: 480, category: 'ç›†èŠ±ç»„åˆ', isHot: false },
            { id: 'JT5151', name: '8å¯¸49å‘ç»„åˆ', price: 180, category: 'ç›†èŠ±ç»„åˆ', isHot: false },
            { id: 'JT7138', name: '7å¯¸138å‘é€Ÿåº¦ä¸æ¿€æƒ…', price: 320, category: 'ç›†èŠ±ç»„åˆ', isHot: false },
            { id: '7168', name: '7å¯¸168å‘å¯Œè´µæ»¡å ‚', price: 360, category: 'ç›†èŠ±ç»„åˆ', isHot: false },
            { id: '7333', name: '7å¯¸333å‘æ˜Ÿæ²³ä¼ è¯´', price: 500, category: 'ç›†èŠ±ç»„åˆ', isHot: true },
            { id: '8228', name: '8å¯¸228å‘é²œè¡£ç­–é©¬', price: 420, category: 'ç›†èŠ±ç»„åˆ', isHot: true },
            { id: 'JT1919', name: '2å¯¸88å‘å·…å³°', price: 300, category: 'ç›†èŠ±ç»„åˆ', isHot: false },
            { id: '4138', name: '4å¯¸138å‘ç»„åˆ', price: 220, category: 'ç›†èŠ±ç»„åˆ', isHot: false },
            { id: '4228', name: '4å¯¸228å‘ç»„åˆ', price: 350, category: 'ç›†èŠ±ç»„åˆ', isHot: false }
        ];

        let cart = {};

        function handleImageError(img, id) {
            if (img.src.endsWith('.jpg')) {
                img.src = `images/${id}.png`;
            } else if (img.src.endsWith('.png')) {
                img.onerror = null;
                img.src = `https://placehold.co/400x400/800000/ffffff?text=${id}`;
            }
        }

        function renderProducts(catFilter = 'all') {
            const grid = document.getElementById('product-grid');
            grid.innerHTML = '';
            const filtered = catFilter === 'all' ? products : products.filter(p => p.category === catFilter);

            filtered.forEach(p => {
                const pureId = p.id.replace('*', '');
                const imgPath = `images/${pureId}.jpg`;
                const videoPath = `videos/${pureId}.mp4`;
                
                const card = document.createElement('div');
                card.className = 'product-card bg-white rounded-xl overflow-hidden shadow-lg flex flex-col transition-all';
                card.innerHTML = `
                    <div class="aspect-square bg-gray-100 flex items-center justify-center relative overflow-hidden">
                        <img src="${imgPath}" 
                             onclick="openLightbox(this.src)" 
                             class="w-full h-full object-cover cursor-zoom-in" 
                             onerror="handleImageError(this, '${pureId}')">
                        
                        ${p.isHot ? `<div class="absolute top-2 left-2 bg-red-600 text-[8px] text-white px-2 py-0.5 rounded-full font-black z-10 shadow-md">HOT</div>` : ''}
                        
                        <button onclick="openVideo('${videoPath}')" class="absolute bottom-2 right-2 bg-black/70 text-white p-2 rounded-full shadow-lg flex items-center gap-1 scale-90 active:scale-75 transition-transform">
                            <svg width="10" height="10" fill="currentColor" viewBox="0 0 16 16"><path d="M11.596 8.697l-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/></svg>
                            <span class="text-[8px] font-black pr-1">æ•ˆæœ</span>
                        </button>
                    </div>
                    <div class="p-2.5 flex-1">
                        <p class="text-red-700 font-black text-xs tracking-tighter">${p.id}</p>
                        <p class="text-gray-800 text-[10px] font-bold leading-tight line-clamp-2 h-7">${p.name}</p>
                        <p class="text-yellow-600 font-black text-sm mt-1">RM ${p.price.toFixed(2)}</p>
                    </div>
                    <div class="p-2 pt-0">
                        <div class="flex items-center justify-between border rounded-lg h-7 mb-2 bg-gray-50 overflow-hidden">
                            <button onclick="changeQty('${p.id}', -1)" class="w-8 h-full font-bold text-gray-400 hover:bg-gray-200 transition-colors">-</button>
                            <input id="qty-${p.id}" type="number" value="1" min="1" class="w-8 text-center text-[10px] font-black bg-transparent text-gray-800 focus:outline-none">
                            <button onclick="changeQty('${p.id}', 1)" class="w-8 h-full font-bold text-gray-400 hover:bg-gray-200 transition-colors">+</button>
                        </div>
                        <button onclick="addToCart('${p.id}')" class="w-full bg-red-600 text-white py-1.5 rounded-lg text-[10px] font-black hover:bg-red-700 active:scale-95 transition-all shadow-sm">
                            åŠ å…¥è®¢å•
                        </button>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function changeQty(id, delta) {
            const input = document.getElementById(`qty-${id}`);
            input.value = Math.max(1, (parseInt(input.value) || 1) + delta);
        }

        // ä¿®æ”¹åçš„ addToCartï¼šç›´æ¥é€šè¿‡ ID åœ¨å†…å­˜ä¸­æ‰¾ï¼Œä¸å†ä¼ é€’åŒ…å«ç‰¹æ®Šç¬¦å·çš„å­—ç¬¦ä¸²
        function addToCart(id) {
            const product = products.find(p => p.id === id);
            if (!product) return;

            const qtyInput = document.getElementById(`qty-${id}`);
            const qty = parseInt(qtyInput.value) || 1;

            if (cart[id]) {
                cart[id].qty += qty;
            } else {
                cart[id] = { 
                    name: product.name, 
                    price: product.price, 
                    qty: qty 
                };
            }
            
            // é‡ç½®è¾“å…¥æ¡†
            qtyInput.value = 1;
            
            updateCartStats();
            renderCartItems();
        }

        function clearCart() {
            if (Object.keys(cart).length === 0) return;
            if (confirm("ç¡®å®šè¦æ¸…ç©ºæ¸…å•å—ï¼Ÿ")) {
                cart = {};
                updateCartStats();
                renderCartItems();
            }
        }

        function updateCartStats() {
            const count = Object.values(cart).reduce((a, b) => a + b.qty, 0);
            const total = Object.values(cart).reduce((a, b) => a + (b.qty * b.price), 0);
            document.getElementById('cart-count').innerText = count;
            document.getElementById('cart-total-price').innerText = `RM ${total.toFixed(2)}`;
        }

        function renderCartItems() {
            const container = document.getElementById('cart-items');
            const keys = Object.keys(cart);
            if (keys.length === 0) {
                container.innerHTML = '<div class="text-center py-10 text-gray-300 font-bold">å°šæœªæ·»åŠ ä»»ä½•æ¸…å•</div>';
                return;
            }
            container.innerHTML = keys.map(id => `
                <div class="flex justify-between items-center border-b pb-3 border-gray-100">
                    <div class="flex-1 text-left">
                        <span class="text-red-600 font-black text-xs">[${id}]</span>
                        <h4 class="text-[11px] font-bold text-gray-700">${cart[id].name}</h4>
                        <p class="text-[10px] text-gray-400 font-bold">RM ${cart[id].price.toFixed(2)} x ${cart[id].qty}</p>
                    </div>
                    <button onclick="deleteFromCart('${id}')" class="text-red-300 px-2 text-xl hover:text-red-600 transition-colors">&times;</button>
                </div>
            `).join('');
        }

        function deleteFromCart(id) {
            delete cart[id];
            updateCartStats();
            renderCartItems();
        }

        function filterProducts(cat) {
            document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            renderProducts(cat);
        }

        function toggleCart() {
            const modal = document.getElementById('cart-modal');
            modal.classList.toggle('hidden');
            modal.classList.toggle('flex');
        }

        function openLightbox(src) {
            document.getElementById('lightbox-img').src = src;
            document.getElementById('image-lightbox').classList.replace('hidden', 'flex');
        }
        function closeLightbox() { document.getElementById('image-lightbox').classList.replace('flex', 'hidden'); }

        function openVideo(src) {
            const v = document.getElementById('product-video');
            v.src = src;
            document.getElementById('video-lightbox').classList.replace('hidden', 'flex');
            v.play();
        }
        function closeVideo() {
            const v = document.getElementById('product-video');
            v.pause();
            v.src = "";
            document.getElementById('video-lightbox').classList.replace('flex', 'hidden');
        }

        function checkout() {
            if (Object.keys(cart).length === 0) return;
            let total = 0;
            let msg = `ğŸ® *2026 é©¬å¹´çƒŸç«è®¢å•* ğŸ®\n`;
            msg += `ğŸ™‹â€â™‚ï¸ é¡¾é—®: ${currentAgent.name}\n`;
            msg += `----------------------------\n`;
            Object.keys(cart).forEach((id, i) => {
                const item = cart[id];
                const sub = item.price * item.qty;
                total += sub;
                msg += `${i+1}. *[${id}]* ${item.name}\n   ğŸ‘‰ RM ${item.price.toFixed(2)} x ${item.qty} = *RM ${sub.toFixed(2)}*\n`;
            });
            msg += `----------------------------\n`;
            msg += `ğŸ’° *åˆè®¡æ€»é¢: RM ${total.toFixed(2)}*\n`;
            msg += `----------------------------\n`;
            msg += `ç¥æ‚¨é©¬åˆ°æˆåŠŸï¼Œä¸‡äº‹å¦‚æ„ï¼ğŸ`;
            window.open(`https://wa.me/${currentAgent.phone}?text=${encodeURIComponent(msg)}`, '_blank');
        }

        window.onload = () => renderProducts();
    </script>
</body>
</html>